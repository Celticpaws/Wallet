<html>
<head>
    {% load static %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js"></script>
    <script src="https://code.highcharts.com/highcharts.src.js"></script>
   <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
         
</head>
   
<body>
    <div class="container">
        <nav class="blue darken-3">
            <div class="nav-wrapper">
                <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
              <ul id="nav-mobile" class="right hide-on-med-and-down">
                <li class="active"><a href="/">Home</a></li>
                <li><a href="/incomes">Incomes</a></li>
                <li><a href="/outcomes">Outcomes</a></li>
                <li><a href="/transfers">Transfers</a></li>
                <li><a href="/budgets">Budgets</a></li>
              </ul>
            </div>
          </nav>
          <ul class="sidenav" id="mobile-demo">
              <li><a href="/">Home</a></li>
                  <li><a href="/incomes">Incomes</a></li>
                  <li class="active"><a href="/outcomes">Outcomes</a></li>
                  <li><a href="/transfers">Transfers</a></li>
                  <li><a href="/budgets">Budgets</a></li>
            </ul>

            <div class="row">       
                <div class="col s4 section"><h4>Resume</h4></div>
                <div class="col s1 offset-s7"><h4><a class="waves-effect waves-light blue btn modal-trigger" href="#modal1">ADD</a></h4>
                </div>    
            </div>
            <div class="row">
                <ul class="tabs blue darken-3" >
                  {% for month in months %}
                    {%if forloop.counter == thismonth %}
                      <li class="tab col s1"><a id="tab{{forloop.counter}}" class="active" href="#menu{{forloop.counter}}" style="color: rgba(255, 255, 255, 0.9);">{{month}}</a></li>
                    {% else %}
                      <li class="tab col s1"><a id="tab{{forloop.counter}}" href="#menu{{forloop.counter}}" style="color: rgba(255, 255, 255, 0.9);">{{month}}</a></li>
                    {% endif %}
                  {%endfor%}
                </ul>

            {% for start,end,table,total,income,outcome in tables %}

              <div id="menu{{forloop.counter}}" class="col s12">
                  <br><div class="row" style="padding-bottom:3%">
                      <div class="col s1 blue darken-4 " style="color: rgba(255, 255, 255, 0.9);">Inicio</div>
                      <div class="col s3">{{start}}</div>
                      <div class="col s1 blue darken-4 " style="color: rgba(255, 255, 255, 0.9);">Fin</div>
                      <div class="col s3">{{end}}</div>
                      <div class="col s1 blue darken-4" style="color: rgba(255, 255, 255, 0.9);">Hoy</div>
                      <div class="col s3">{{today|date:"d \d\e F \d\e Y"}}</div>
                  </div>
                    <div class="row">
                        <div class="col s6">
                            <table class="highlight">
                                <tr>
                                    <th style="background:white"></th>
                                    {%for account in accounts%}
                                        <th> {{account.id}} </th>
                                    {%endfor%}
                                </tr>
                                {%for values in table%}
                                    <tr>
                                        {%for v in values%}
                                            <td> {{v}} €</td>
                                        {%endfor%}
                                    </tr>
                                {%endfor%}
                            </table>
                            <div class="info col-sm-6 col-sm-offset-3">Balance: {{total}} €</div>
                        </div>
                    <div id="graph{{forloop.counter}}" class="col s6">
                    </div>
                    </div>
                    <div class="col-lg-12">
                    </div>
                    <script>
                            var pieColors = (function () {
                                var colors = [],
                                  base = '#039be5',
                                  i;
                                for (i = 0; i < 10; i += 1) {
                                  colors.push(Highcharts.Color(base).brighten((i - 3) / 7).get());
                                }
                                return colors;
                              }());
                              
                              // Build the chart
                              Highcharts.chart('graph{{forloop.counter}}', {
                                chart: {
                                  plotBackgroundColor: null,
                                  plotBorderWidth: 0,
                                  plotShadow: false
                                },
                                title: {
                                  text: 'Balance',
                                  align: 'center',
                                  verticalAlign: 'middle',
                                  y: 40
                                },
                                tooltip: {
                                  pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                                },
                                plotOptions: {
                                  pie: {
                                    colors: pieColors,
                                    dataLabels: {
                                      enabled: true,
                                      distance: -50,
                                      style: {
                                        fontWeight: 'bold',
                                        color: 'white'
                                      }
                                    },
                                    startAngle: -90,
                                    endAngle: 90,
                                    center: ['50%', '75%'],
                                    size: '110%'
                                  }
                                },
                                series: [{
                                  type: 'pie',
                                  name: 'Percentage',
                                  innerSize: '50%',
                                  data: [
                                    ['Income', {{income}}],
                                    ['Outcome',{{outcome}}],
                                  ]
                                }]
                              });
                    </script>
              </div>
            {%endfor%}
            </div>
        </div>
          

        <script type="text/javascript">
          $(document).ready(function(){
            $('.modal').modal();
          });
          $(document).ready(function(){
            $('.tabs').tabs();
          });
          $(document).ready(function(){
            $('.datepicker').datepicker();
          });
        </script>


</body>
</html>